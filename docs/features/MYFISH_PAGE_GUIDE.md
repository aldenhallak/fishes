# 我的鱼页面 (myfish.html) 使用指南

## 页面概述

**我的鱼页面** 是一个静态网格布局页面，用于展示用户自己创作的鱼和收藏的鱼。与动画鱼缸页面 (mytank.html) 不同，此页面以卡片形式展示，提供更详细的信息和更便捷的管理功能。

## 功能特点

### 1. 鱼的展示
- **网格卡片布局**: 清晰展示每条鱼的详细信息
- **鱼类型标识**:
  - `ME` 绿色徽章：自己创作的鱼
  - `❤️ 收藏` 粉色徽章：收藏的鱼
  - `💀 已逝` 灰色徽章：已经死亡的鱼

### 2. 详细信息
每张鱼卡片显示：
- 鱼的图片
- 艺术家名称
- 创作日期
- 等级星级
- 健康值 (当前/最大)

### 3. 排序功能
四种排序方式：
- 📅 **按日期**: 最新创作的排在前面（默认）
- ⭐ **按等级**: 等级最高的排在前面
- 🔤 **按名称**: 艺术家名称字母顺序
- 🏷️ **按类型**: 自己的 > 收藏的 > 死亡的

### 4. 统计信息
顶部显示：
- 总鱼数量
- 自己创作的数量
- 收藏的数量
- 存活的数量
- 平均等级

### 5. 添加到鱼缸
- 点击任意鱼卡片，可以将鱼添加到您的自定义鱼缸中

## 使用方法

### 访问页面

1. **登录要求**: 必须登录才能查看此页面
2. **访问方式**: 
   - 点击任意页面导航栏中的 `🐟 我的鱼` 链接
   - 或直接访问: `http://localhost:3000/myfish.html`

### 第一次使用

如果您还没有鱼：
1. 页面会显示空状态提示
2. 点击 `🎨 开始绘画` 创作您的第一条鱼
3. 或点击 `🐠 浏览鱼缸` 去收藏其他用户的鱼

### 排序和筛选

1. 使用顶部的排序按钮切换排序方式
2. 点击按钮后，列表会立即重新排序
3. 当前激活的排序按钮会高亮显示

### 添加到鱼缸

1. 点击任意鱼卡片
2. 在弹出的模态框中选择要添加到的鱼缸
3. 确认后，鱼会被添加到指定鱼缸

## 与其他页面的区别

### vs mytank.html (我的鱼缸)
- **mytank.html**: 动画游动的鱼缸，观赏体验
- **myfish.html**: 静态卡片网格，管理体验
- 两者数据来源相同，展示方式不同

### vs rank.html (排行榜)
- **rank.html**: 展示全局所有用户的鱼，可投票和举报
- **myfish.html**: 只展示自己的鱼，无投票/举报功能

### vs tank.html (全局鱼缸)
- **tank.html**: 全局动画鱼缸，显示所有用户的鱼
- **myfish.html**: 个人静态列表，只显示自己的鱼

## 技术细节

### API 端点
- **接口**: `/api/fishtank/my-fish`
- **方法**: GET
- **认证**: 需要 Bearer Token (从 localStorage 获取)

### 返回数据格式
```json
{
  "success": true,
  "fish": [
    {
      "id": "鱼ID",
      "artist": "艺术家名称",
      "image_url": "图片URL",
      "created_at": "创建时间",
      "level": 等级,
      "health": 当前健康值,
      "max_health": 最大健康值,
      "is_alive": true/false,
      "isOwn": true/false,
      "isFavorited": true/false
    }
  ],
  "stats": {
    "totalFish": 总数,
    "ownFish": 自己的数量,
    "favoritedFish": 收藏的数量,
    "aliveFish": 存活数量,
    "avgLevel": 平均等级
  }
}
```

### 相关文件
- **HTML**: `myfish.html`
- **JavaScript**: `src/js/myfish.js`
- **API**: `api/fishtank/my-fish.js`
- **样式**: 内嵌在 `myfish.html` 中

## 常见问题

### Q: 为什么看不到"我的鱼"链接？
**A**: 需要先登录。登录后，导航栏会自动显示 `🐟 我的鱼` 链接。

### Q: 为什么页面显示"还没有鱼"？
**A**: 可能原因：
1. 您确实还没有创作或收藏任何鱼
2. 您的鱼还未被批准 (is_approved = false)
3. 收藏功能暂时不可用（fish_favorites 表未追踪）

### Q: 如何创作鱼？
**A**: 
1. 点击导航栏的 `🎨 绘画` 或首页的绘画按钮
2. 使用画布工具绘制您的鱼
3. 点击提交，等待审核通过

### Q: 如何收藏鱼？
**A**: 
1. 在 `rank.html` 或 `tank.html` 页面
2. 找到喜欢的鱼
3. 点击 ❤️ 收藏按钮
4. 注意：目前收藏功能可能不可用（需要 Hasura 追踪 fish_favorites 表）

### Q: 死亡的鱼会显示吗？
**A**: 会显示，但会有 `💀 已逝` 灰色徽章标识，并且会排在列表后面（当按类型排序时）。

### Q: 可以删除我的鱼吗？
**A**: 当前版本不支持直接删除。鱼只会因为健康值降为 0 而"死亡"。

## 开发者说明

### 添加新功能

如需添加新功能，编辑以下文件：
- **UI 修改**: `myfish.html` (内嵌样式和结构)
- **逻辑修改**: `src/js/myfish.js`
- **API 修改**: `api/fishtank/my-fish.js`

### 调试技巧

1. **打开浏览器控制台** (F12)
2. 查看加载日志：
   ```
   🐟 我的鱼页面初始化...
   ✅ 加载了 X 条鱼
   ```
3. 如果出错，查看错误信息：
   ```
   ❌ 加载鱼数据失败: ...
   ```

### 常见错误

#### 错误: "请先登录"
- 原因: localStorage 中没有 userToken
- 解决: 重新登录

#### 错误: "HTTP 500: Internal Server Error"
- 原因: 后端 API 错误
- 解决: 查看后端服务器日志 (npm run dev 的终端)

#### 错误: "加载失败"
- 原因: 可能是网络问题或 API 不可用
- 解决: 检查后端服务器是否运行

## 未来计划

1. **收藏功能完善**: 等待 Hasura 追踪 fish_favorites 表
2. **筛选功能**: 添加"只看存活"、"只看自己的"等筛选选项
3. **批量操作**: 选择多条鱼进行批量添加到鱼缸
4. **鱼详情页**: 点击查看更详细的鱼信息和历史记录
5. **分享功能**: 分享单条鱼或整个收藏

## 反馈和支持

如有问题或建议，请联系开发团队。










