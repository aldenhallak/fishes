<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é±¼æ”»å‡»åŠ¨ç”»Demo - FishArt</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 900px;
            width: 100%;
        }
        
        h1 {
            text-align: center;
            color: #667eea;
            margin-bottom: 10px;
            font-size: 28px;
        }
        
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 20px;
            font-size: 14px;
        }
        
        #demo-canvas {
            width: 100%;
            height: 400px;
            border: 3px solid #667eea;
            border-radius: 12px;
            background: linear-gradient(to bottom, #e6f3ff 0%, #b3d9ff 100%);
            display: block;
            cursor: pointer;
        }
        
        .controls {
            margin-top: 20px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.2);
        }
        
        .btn-attack {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
            color: white;
        }
        
        .btn-heal {
            background: linear-gradient(135deg, #51cf66 0%, #37b24d 100%);
            color: white;
        }
        
        .btn-auto {
            background: linear-gradient(135deg, #ffd43b 0%, #fab005 100%);
            color: #333;
        }
        
        .stats {
            margin-top: 20px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .fish-stat {
            padding: 15px;
            border-radius: 10px;
            background: #f8f9fa;
        }
        
        .fish-stat h3 {
            margin-bottom: 10px;
            color: #667eea;
            font-size: 18px;
        }
        
        .stat-item {
            display: flex;
            justify-content: space-between;
            margin: 5px 0;
            font-size: 14px;
        }
        
        .stat-label {
            color: #666;
        }
        
        .stat-value {
            font-weight: bold;
            color: #333;
        }
        
        .health-bar {
            width: 100%;
            height: 20px;
            background: #ffcccc;
            border-radius: 10px;
            overflow: hidden;
            margin-top: 5px;
        }
        
        .health-fill {
            height: 100%;
            background: linear-gradient(90deg, #51cf66 0%, #37b24d 100%);
            transition: width 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
            font-weight: bold;
        }
        
        .info {
            margin-top: 20px;
            padding: 15px;
            background: #e7f5ff;
            border-radius: 8px;
            font-size: 14px;
            color: #1864ab;
            text-align: center;
        }
        
        @media (max-width: 600px) {
            .stats {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸŸ é±¼æ”»å‡»åŠ¨ç”»Demo ğŸŸ</h1>
        <p class="subtitle">ç‚¹å‡»ç”»å¸ƒæˆ–æŒ‰é’®æŸ¥çœ‹æ”»å‡»æ•ˆæœ</p>
        
        <canvas id="demo-canvas" width="800" height="400"></canvas>
        
        <div class="controls">
            <button class="btn btn-attack" onclick="triggerAttack('left')">ğŸ”´ çº¢é±¼æ”»å‡»</button>
            <button class="btn btn-attack" onclick="triggerAttack('right')">ğŸ”µ è“é±¼æ”»å‡»</button>
            <button class="btn btn-heal" onclick="healAll()">ğŸ’š å…¨ä½“å›è¡€</button>
            <button class="btn btn-auto" id="autoBtn" onclick="toggleAuto()">âš¡ è‡ªåŠ¨æˆ˜æ–—</button>
        </div>
        
        <div class="stats">
            <div class="fish-stat">
                <h3>ğŸ”´ çº¢é±¼ (å·¦)</h3>
                <div class="stat-item">
                    <span class="stat-label">æ”»å‡»åŠ›:</span>
                    <span class="stat-value" id="left-attack">15</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">é˜²å¾¡åŠ›:</span>
                    <span class="stat-value" id="left-defense">8</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">ç”Ÿå‘½å€¼:</span>
                    <span class="stat-value" id="left-health">100/100</span>
                </div>
                <div class="health-bar">
                    <div class="health-fill" id="left-health-bar" style="width: 100%;">100%</div>
                </div>
            </div>
            
            <div class="fish-stat">
                <h3>ğŸ”µ è“é±¼ (å³)</h3>
                <div class="stat-item">
                    <span class="stat-label">æ”»å‡»åŠ›:</span>
                    <span class="stat-value" id="right-attack">12</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">é˜²å¾¡åŠ›:</span>
                    <span class="stat-value" id="right-defense">10</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">ç”Ÿå‘½å€¼:</span>
                    <span class="stat-value" id="right-health">100/100</span>
                </div>
                <div class="health-bar">
                    <div class="health-fill" id="right-health-bar" style="width: 100%;">100%</div>
                </div>
            </div>
        </div>
        
        <div class="info">
            ğŸ’¡ æç¤º: ç‚¹å‡»ç”»å¸ƒä¸Šçš„é±¼è®©å®ƒä»¬æ”»å‡»å¯¹æ–¹ï¼Œæˆ–ä½¿ç”¨æŒ‰é’®æ§åˆ¶ã€‚æ”»å‡»ä¼šæ˜¾ç¤ºä¼¤å®³æ•°å­—å’Œç²’å­æ•ˆæœï¼
        </div>
    </div>

    <script>
        const canvas = document.getElementById('demo-canvas');
        const ctx = canvas.getContext('2d');
        
        // é±¼çš„æ•°æ®
        let leftFish = {
            x: 150,
            y: 200,
            width: 100,
            height: 60,
            color: '#ff6b6b',
            direction: 1,
            attack: 15,
            defense: 8,
            health: 100,
            maxHealth: 100,
            phase: 0,
            wiggleTime: 0,
            isAttacking: false,
            attackCooldown: 0
        };
        
        let rightFish = {
            x: 550,
            y: 200,
            width: 100,
            height: 60,
            color: '#4dabf7',
            direction: -1,
            attack: 12,
            defense: 10,
            health: 100,
            maxHealth: 100,
            phase: Math.PI,
            wiggleTime: 0,
            isAttacking: false,
            attackCooldown: 0
        };
        
        // ç²’å­ç³»ç»Ÿ
        let particles = [];
        let damageNumbers = [];
        let autoMode = false;
        let autoInterval = null;
        
        // ç»˜åˆ¶ç®€å•çš„é±¼å½¢çŠ¶
        function drawFish(fish, time) {
            ctx.save();
            
            // æ”»å‡»æ—¶çš„éœ‡åŠ¨æ•ˆæœ
            let shake = 0;
            if (fish.isAttacking) {
                shake = Math.sin(time * 50) * 3;
            }
            
            // è®¡ç®—æ‘†å°¾
            const tailWiggle = Math.sin(time * 3 + fish.phase) * 15;
            
            ctx.translate(fish.x + shake, fish.y);
            
            // é•œåƒï¼ˆå¦‚æœå‘å·¦ï¼‰
            if (fish.direction === -1) {
                ctx.scale(-1, 1);
                ctx.translate(-fish.width, 0);
            }
            
            // é±¼èº«ä½“ï¼ˆæ¤­åœ†ï¼‰
            ctx.fillStyle = fish.color;
            ctx.beginPath();
            ctx.ellipse(fish.width/2, fish.height/2, fish.width/2.5, fish.height/2.5, 0, 0, Math.PI * 2);
            ctx.fill();
            
            // é±¼å°¾ï¼ˆä¸‰è§’å½¢ï¼Œå¸¦æ‘†åŠ¨ï¼‰
            ctx.fillStyle = fish.color;
            ctx.beginPath();
            ctx.moveTo(10, fish.height/2);
            ctx.lineTo(0, fish.height/2 - 20 + tailWiggle);
            ctx.lineTo(0, fish.height/2 + 20 + tailWiggle);
            ctx.closePath();
            ctx.fill();
            
            // çœ¼ç›
            ctx.fillStyle = 'white';
            ctx.beginPath();
            ctx.arc(fish.width * 0.7, fish.height * 0.4, 8, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = 'black';
            ctx.beginPath();
            ctx.arc(fish.width * 0.7, fish.height * 0.4, 4, 0, Math.PI * 2);
            ctx.fill();
            
            ctx.restore();
            
            // è¡€æ¡
            drawHealthBar(fish);
        }
        
        // ç»˜åˆ¶è¡€æ¡
        function drawHealthBar(fish) {
            const barWidth = fish.width;
            const barHeight = 8;
            const barX = fish.x;
            const barY = fish.y - 20;
            
            // èƒŒæ™¯
            ctx.fillStyle = '#ffcccc';
            ctx.fillRect(barX, barY, barWidth, barHeight);
            
            // å½“å‰è¡€é‡
            const healthPercent = fish.health / fish.maxHealth;
            ctx.fillStyle = healthPercent > 0.5 ? '#51cf66' : (healthPercent > 0.25 ? '#ffd43b' : '#ff6b6b');
            ctx.fillRect(barX, barY, barWidth * healthPercent, barHeight);
            
            // è¾¹æ¡†
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 2;
            ctx.strokeRect(barX, barY, barWidth, barHeight);
        }
        
        // åˆ›å»ºæ”»å‡»ç²’å­
        function createAttackParticles(attacker, target) {
            const midX = (attacker.x + target.x + target.width) / 2;
            const midY = (attacker.y + target.y + target.height) / 2;
            
            // åˆ›å»ºå†²å‡»æ³¢ç²’å­
            for (let i = 0; i < 20; i++) {
                const angle = (Math.PI * 2 * i) / 20;
                particles.push({
                    x: midX,
                    y: midY,
                    vx: Math.cos(angle) * (Math.random() * 3 + 2),
                    vy: Math.sin(angle) * (Math.random() * 3 + 2),
                    life: 1,
                    maxLife: 1,
                    size: Math.random() * 6 + 3,
                    color: attacker.color
                });
            }
            
            // åˆ›å»ºå‡»ä¸­ç‰¹æ•ˆ
            for (let i = 0; i < 15; i++) {
                particles.push({
                    x: target.x + target.width / 2,
                    y: target.y + target.height / 2,
                    vx: (Math.random() - 0.5) * 8,
                    vy: (Math.random() - 0.5) * 8,
                    life: 1,
                    maxLife: 1,
                    size: Math.random() * 4 + 2,
                    color: '#ffffff'
                });
            }
        }
        
        // æ˜¾ç¤ºä¼¤å®³æ•°å­—
        function showDamageNumber(target, damage) {
            damageNumbers.push({
                x: target.x + target.width / 2,
                y: target.y,
                damage: damage,
                life: 1,
                vy: -2
            });
        }
        
        // æ‰§è¡Œæ”»å‡»
        function performAttack(attacker, target) {
            if (attacker.attackCooldown > 0 || target.health <= 0) return;
            
            // è®¡ç®—ä¼¤å®³
            const damage = Math.max(1, attacker.attack - target.defense);
            target.health = Math.max(0, target.health - damage);
            
            // æ”»å‡»åŠ¨ç”»
            attacker.isAttacking = true;
            attacker.attackCooldown = 60; // 1ç§’å†·å´ï¼ˆ60å¸§ï¼‰
            
            // åˆ›å»ºç²’å­æ•ˆæœ
            createAttackParticles(attacker, target);
            
            // æ˜¾ç¤ºä¼¤å®³æ•°å­—
            showDamageNumber(target, damage);
            
            // éœ‡å±æ•ˆæœ
            canvas.style.transform = 'scale(1.02)';
            setTimeout(() => {
                canvas.style.transform = 'scale(1)';
            }, 100);
            
            // æ›´æ–°UI
            updateStats();
            
            // 0.3ç§’åç»“æŸæ”»å‡»åŠ¨ç”»
            setTimeout(() => {
                attacker.isAttacking = false;
            }, 300);
        }
        
        // æ›´æ–°ç»Ÿè®¡æ•°æ®
        function updateStats() {
            // å·¦é±¼
            document.getElementById('left-health').textContent = `${Math.ceil(leftFish.health)}/${leftFish.maxHealth}`;
            const leftPercent = (leftFish.health / leftFish.maxHealth) * 100;
            document.getElementById('left-health-bar').style.width = leftPercent + '%';
            document.getElementById('left-health-bar').textContent = Math.ceil(leftPercent) + '%';
            
            // å³é±¼
            document.getElementById('right-health').textContent = `${Math.ceil(rightFish.health)}/${rightFish.maxHealth}`;
            const rightPercent = (rightFish.health / rightFish.maxHealth) * 100;
            document.getElementById('right-health-bar').style.width = rightPercent + '%';
            document.getElementById('right-health-bar').textContent = Math.ceil(rightPercent) + '%';
            
            // æ£€æŸ¥èƒœè´Ÿ
            if (leftFish.health <= 0) {
                setTimeout(() => alert('ğŸ”µ è“é±¼è·èƒœï¼'), 100);
                if (autoMode) toggleAuto();
            } else if (rightFish.health <= 0) {
                setTimeout(() => alert('ğŸ”´ çº¢é±¼è·èƒœï¼'), 100);
                if (autoMode) toggleAuto();
            }
        }
        
        // è§¦å‘æ”»å‡»
        function triggerAttack(side) {
            if (side === 'left') {
                performAttack(leftFish, rightFish);
            } else {
                performAttack(rightFish, leftFish);
            }
        }
        
        // å›è¡€
        function healAll() {
            leftFish.health = leftFish.maxHealth;
            rightFish.health = rightFish.maxHealth;
            updateStats();
        }
        
        // è‡ªåŠ¨æˆ˜æ–—
        function toggleAuto() {
            autoMode = !autoMode;
            const btn = document.getElementById('autoBtn');
            
            if (autoMode) {
                btn.textContent = 'â¸ï¸ åœæ­¢æˆ˜æ–—';
                btn.style.background = 'linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%)';
                autoInterval = setInterval(() => {
                    if (leftFish.health > 0 && rightFish.health > 0) {
                        // éšæœºé€‰æ‹©æ”»å‡»è€…
                        if (Math.random() > 0.5) {
                            performAttack(leftFish, rightFish);
                        } else {
                            performAttack(rightFish, leftFish);
                        }
                    } else {
                        toggleAuto();
                    }
                }, 1500);
            } else {
                btn.textContent = 'âš¡ è‡ªåŠ¨æˆ˜æ–—';
                btn.style.background = 'linear-gradient(135deg, #ffd43b 0%, #fab005 100%)';
                if (autoInterval) {
                    clearInterval(autoInterval);
                    autoInterval = null;
                }
            }
        }
        
        // ç”»å¸ƒç‚¹å‡»äº‹ä»¶
        canvas.addEventListener('click', (e) => {
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            // æ£€æµ‹ç‚¹å‡»äº†å“ªæ¡é±¼
            if (x >= leftFish.x && x <= leftFish.x + leftFish.width &&
                y >= leftFish.y && y <= leftFish.y + leftFish.height) {
                triggerAttack('left');
            } else if (x >= rightFish.x && x <= rightFish.x + rightFish.width &&
                       y >= rightFish.y && y <= rightFish.y + rightFish.height) {
                triggerAttack('right');
            }
        });
        
        // ä¸»åŠ¨ç”»å¾ªç¯
        let lastTime = 0;
        function animate(currentTime) {
            const deltaTime = (currentTime - lastTime) / 1000;
            lastTime = currentTime;
            const time = currentTime / 1000;
            
            // æ¸…ç©ºç”»å¸ƒ
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // ç»˜åˆ¶èƒŒæ™¯æ³¢çº¹
            ctx.fillStyle = 'rgba(255, 255, 255, 0.1)';
            for (let i = 0; i < 5; i++) {
                ctx.beginPath();
                ctx.arc(canvas.width / 2, canvas.height / 2, 50 + i * 40 + (time * 30) % 200, 0, Math.PI * 2);
                ctx.fill();
            }
            
            // æ›´æ–°å’Œç»˜åˆ¶ç²’å­
            for (let i = particles.length - 1; i >= 0; i--) {
                const p = particles[i];
                p.x += p.vx;
                p.y += p.vy;
                p.life -= deltaTime;
                
                if (p.life <= 0) {
                    particles.splice(i, 1);
                    continue;
                }
                
                const alpha = p.life / p.maxLife;
                ctx.fillStyle = p.color + Math.floor(alpha * 255).toString(16).padStart(2, '0');
                ctx.beginPath();
                ctx.arc(p.x, p.y, p.size * alpha, 0, Math.PI * 2);
                ctx.fill();
            }
            
            // æ›´æ–°å’Œç»˜åˆ¶ä¼¤å®³æ•°å­—
            ctx.font = 'bold 24px Arial';
            ctx.textAlign = 'center';
            for (let i = damageNumbers.length - 1; i >= 0; i--) {
                const dn = damageNumbers[i];
                dn.y += dn.vy;
                dn.life -= deltaTime;
                
                if (dn.life <= 0) {
                    damageNumbers.splice(i, 1);
                    continue;
                }
                
                const alpha = dn.life;
                ctx.fillStyle = `rgba(255, 50, 50, ${alpha})`;
                ctx.strokeStyle = `rgba(255, 255, 255, ${alpha})`;
                ctx.lineWidth = 3;
                ctx.strokeText(`-${dn.damage}`, dn.x, dn.y);
                ctx.fillText(`-${dn.damage}`, dn.x, dn.y);
            }
            
            // ç»˜åˆ¶é±¼
            drawFish(leftFish, time);
            drawFish(rightFish, time);
            
            // æ›´æ–°å†·å´æ—¶é—´
            if (leftFish.attackCooldown > 0) leftFish.attackCooldown--;
            if (rightFish.attackCooldown > 0) rightFish.attackCooldown--;
            
            requestAnimationFrame(animate);
        }
        
        // å¯åŠ¨åŠ¨ç”»
        requestAnimationFrame(animate);
        updateStats();
    </script>
</body>
</html>


